[2017年 04月 22日 星期六 22:00:33 CST] Start installation.
[2017年 04月 22日 星期六 22:00:34 CST] Initialize cgroup fs.
INFO     [MainThread] treadmill.sproc.cgroup:111 - Configuring CPU limits: treadmill cores: 3, treadmill: 20447, treadmill core: 204, treadmill apps: 20243
INFO     [MainThread] treadmill.sproc.cgroup:150 - Configuring memory limits: total: 7.6G, treadmill total: 4.0G, treadmill core: 512.0M
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/cpu.shares : 20447
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/system/cpu.shares : 6815
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/cpu.shares : 204
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/apps/cpu.shares : 20243
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpuset/system/cpuset.mems : 0
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpuset/treadmill/cpuset.mems : 0
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpuset/treadmill/cpuset.cpus : 0-2
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpuset/system/cpuset.cpus : 3-3
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/memory.limit_in_bytes : 4294967296
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/memory.memsw.limit_in_bytes : 4294967296
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/memory.oom_control : 0
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/memory.limit_in_bytes : 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/memory.memsw.limit_in_bytes : 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/memory.soft_limit_in_bytes : 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/apps/memory.limit_in_bytes : 3758096384
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/apps/memory.memsw.limit_in_bytes : 3758096384
[2017年 04月 22日 星期六 22:00:34 CST] The root of the server is /tmp/treadmill.server.local, start server process.
[2017年 04月 22日 星期六 22:00:34 CST] Start localdisk service process.
[2017年 04月 22日 星期六 22:00:34 CST] Start cgroup service process.
[2017年 04月 22日 星期六 22:00:34 CST] Start network service process.
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/tasks : 20622
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/tasks : 20622
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/tasks : 20622
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/core/treadmill/tasks : 20622
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-LocalDiskResourceService:60>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['lvm', 'vgchange', '--activate', 'y', 'treadmill']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/tasks : 20621
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/tasks : 20621
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/tasks : 20621
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/core/treadmill/tasks : 20621
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-CgroupResourceService:60>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cgroup_svc/resources' (id: 1)
DEBUG    [MainThread] treadmill.services._base_service:578 - Registered 6: {'callback': <functools.partial object at 0x32b6730>, 'events': 1}
DEBUG    [MainThread] treadmill.services._base_service:578 - Registered 4: {'callback': <functools.partial object at 0x32b67e0>, 'events': 1}
DEBUG    [MainThread] treadmill.services._base_service:578 - Registered 3: {'callback': <functools.partial object at 0x32b6788>, 'events': 1}
  0 logical volume(s) in volume group "treadmill" now active
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:140 - check_output environ: (), ['lvm', 'lvdisplay', '--colon', 'treadmill']
DEBUG    [MainThread] treadmill.subproc:153 - Finished.
DEBUG    [MainThread] treadmill.subproc:140 - check_output environ: (), ['lvm', 'vgdisplay', '--colon', 'treadmill']
DEBUG    [MainThread] treadmill.subproc:153 - Finished.
INFO     [MainThread] treadmill.services.localdisk_service:330 - Group 'treadmill' available space: 1069547520 (bytes)
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/localdisk_svc/resources' (id: 1)
DEBUG    [MainThread] treadmill.services._base_service:578 - Registered 6: {'callback': <functools.partial object at 0x248d998>, 'events': 1}
DEBUG    [MainThread] treadmill.services._base_service:578 - Registered 4: {'callback': <functools.partial object at 0x24a92b8>, 'events': 1}
DEBUG    [MainThread] treadmill.services._base_service:578 - Registered 3: {'callback': <functools.partial object at 0x24a9260>, 'events': 1}
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/tasks : 20623
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/tasks : 20623
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/tasks : 20623
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/core/treadmill/tasks : 20623
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/cpu.shares : 204
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/tasks : 20617
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/tasks : 20617
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/tasks : 20617
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-NetworkResourceService:60>
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/core/treadmill/tasks : 20617
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'tm0', 'up']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/cpu.shares : 204
INFO     [MainThread] treadmill.sproc.init:50 - Initializing Treadmill: /tmp/treadmill.server.local
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:165 - ZK connection state: CONNECTED
WARNING  [MainThread] treadmill.utils:477 - notification-fd does not exist.
DEBUG    [MainThread] treadmill.services._base_service:538 - Event on 3: {'callback': <functools.partial object at 0x24a9260>, 'events': 1}
DEBUG    [MainThread] treadmill.services._base_service:538 - Event on 3: {'callback': <functools.partial object at 0x32b6788>, 'events': 1}
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'tm1', 'up']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'br0', 'up']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['brctl', 'setfd', 'br0', '0']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.netdev:487 - Setting '/proc/sys/net/ipv4/conf/tm0/route_localnet' to 1
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/network_svc/resources' (id: 1)
DEBUG    [MainThread] treadmill.services._base_service:578 - Registered 6: {'callback': <functools.partial object at 0x3237e68>, 'events': 1}
DEBUG    [MainThread] treadmill.services._base_service:578 - Registered 4: {'callback': <functools.partial object at 0x3237ec0>, 'events': 1}
DEBUG    [MainThread] treadmill.services._base_service:578 - Registered 3: {'callback': <functools.partial object at 0x3237f18>, 'events': 1}
DEBUG    [MainThread] treadmill.services._base_service:538 - Event on 3: {'callback': <functools.partial object at 0x3237f18>, 'events': 1}
INFO     [MainThread] treadmill.sproc.init:78 - Checking blackout list.
INFO     [MainThread] treadmill.sproc.init:93 - /server.presence/localhost does not exist.
INFO     [MainThread] treadmill.appmgr.initialize:14 - Initializing once.
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'restore']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['iptables_restore']
DEBUG    [MainThread] treadmill.iptables:202 - Reloading Treadmill filter rules
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['iptables_restore', '--noflush']
INFO     [MainThread] treadmill.fs:237 - Processing plugins: /home/vagrant/treadmill/lib/python/treadmill/plugins/fs
INFO     [MainThread] treadmill.fs:246 - Loading: treadmill.plugins.fs.localfs
INFO     [MainThread] treadmill.fs:246 - Loading: treadmill.plugins.fs.nfs
INFO     [MainThread] treadmill.sproc.init:102 - Registering node: /servers/localhost: localhost, {'parent': 'mock-parent', 'up_since': 1492867852.259946, 'memory': '3584M', 'disk': '1020M', 'cpu': '404%'}
DEBUG    [MainThread] treadmill.zkutils:434 - update /servers/localhost
DEBUG    [MainThread] treadmill.sproc.init:106 - host_acl: ACL(perms=31, acl_list=['ALL'], id=Id(scheme='world', id='anyone'))
DEBUG    [MainThread] treadmill.zkutils:407 - put (default_acl=True): /server.presence/localhost acl=[ACL(perms=1, acl_list=['READ'], id=Id(scheme='world', id='anyone')), ACL(perms=31, acl_list=['ALL'], id=Id(scheme='world', id='anyone')), ACL(perms=31, acl_list=['ALL'], id=Id(scheme='world', id='anyone')), ACL(perms=31, acl_list=['ALL'], id=Id(scheme='world', id='anyone'))] seq=False
DEBUG    [MainThread] treadmill.netdev:487 - Setting '/proc/sys/net/ipv4/conf/tm0/forwarding' to 1
INFO     [MainThread] treadmill.sproc.init:117 - Ready.
[2017年 04月 22日 星期六 22:00:39 CST] Start event daemon process.
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/tasks : 20705
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/tasks : 20705
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/tasks : 20705
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/core/treadmill/tasks : 20705
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/cpu.shares : 204
INFO     [MainThread] treadmill.eventmgr:52 - init eventmgr: /tmp/treadmill.server.local
INFO     [MainThread] treadmill.eventmgr:65 - Establish connection to Zookeeper and subscribes to node events.
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-EventMgr:60>
INFO     [MainThread] treadmill.eventmgr:72 - Setup watchdog.
INFO     [MainThread] treadmill.eventmgr:76 - Start the timer for /tmp/treadmill.server.local/watchdogs
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.eventmgr:99 - Presence is up.
INFO     [MainThread] treadmill.eventmgr:141 - expected : mock-user.mock-app#0000000000
INFO     [MainThread] treadmill.eventmgr:142 - actual   : 
INFO     [MainThread] treadmill.eventmgr:143 - extra    : 
INFO     [MainThread] treadmill.eventmgr:144 - missing  : mock-user.mock-app#0000000000
INFO     [MainThread] treadmill.eventmgr:176 - Created cache manifest: /tmp/treadmill.server.local/cache/mock-user.mock-app#0000000000
INFO     [MainThread] treadmill.eventmgr:141 - expected : mock-user.mock-app#0000000000
INFO     [MainThread] treadmill.eventmgr:142 - actual   : mock-user.mock-app#0000000000
INFO     [MainThread] treadmill.eventmgr:143 - extra    : 
INFO     [MainThread] treadmill.eventmgr:144 - missing  : 
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
[2017年 04月 22日 星期六 22:00:40 CST] Start cleanup process.
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 20736
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 20736
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 20736
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 20736
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
[2017年 04月 22日 星期六 22:00:41 CST] Start app config manager process.
/tmp/treadmill.server.local
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/tasks : 20754
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/tasks : 20754
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/tasks : 20754
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/treadmill
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/core/treadmill/tasks : 20754
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/core/treadmill/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/core/treadmill/cpu.shares : 204
INFO     [MainThread] treadmill.appcfgmgr:62 - init appcfgmgr: /tmp/treadmill.server.local
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-AppCfgMgr:120>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cache' (id: 1)
INFO     [Thread-2  ] treadmill.eventmgr:141 - expected : mock-user.mock-app#0000000000,mock-user.mock-app#0000000001
INFO     [Thread-2  ] treadmill.eventmgr:142 - actual   : mock-user.mock-app#0000000000
INFO     [Thread-2  ] treadmill.eventmgr:143 - extra    : 
INFO     [Thread-2  ] treadmill.eventmgr:144 - missing  : mock-user.mock-app#0000000001
INFO     [Thread-2  ] treadmill.eventmgr:176 - Created cache manifest: /tmp/treadmill.server.local/cache/mock-user.mock-app#0000000001
DEBUG    [Thread-2  ] treadmill.eventmgr:191 - cache notify (seen: True)
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.mock-user.mock-app#0000000001-hEcnG6, wd=1, mask=CREATE, cookie=0>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.mock-user.mock-app#0000000001-hEcnG6, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.mock-user.mock-app#0000000001-hEcnG6, wd=1, mask=MOVED_FROM, cookie=4019>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/mock-user.mock-app#0000000001, wd=1, mask=MOVED_TO, cookie=4019>
DEBUG    [MainThread] treadmill.appcfgmgr:170 - Inactive in created event handler.
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
INFO     [MainThread] treadmill.appcfgmgr:214 - Cache folder ready. Processing events.
INFO     [MainThread] treadmill.appcfgmgr:255 - running set([])
INFO     [MainThread] treadmill.appcfgmgr:326 - mock-user.mock-app#0000000000 - Configuring
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
ERROR    [MainThread] treadmill.appmgr.configure:74 - Unable to find proid 'mock-user' in passwd database.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/configure.py", line 70, in configure
    pwd.getpwnam(app.proid)
KeyError: 'getpwnam(): name not found: mock-user'
ERROR    [MainThread] treadmill.appcfgmgr:335 - mock-user.mock-app#0000000000 - Error configuring ('/tmp/treadmill.server.local/cache/mock-user.mock-app#0000000000')
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appcfgmgr.py", line 327, in _configure
    container_dir = app_cfg.configure(self.tm_env, event_file)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/configure.py", line 70, in configure
    pwd.getpwnam(app.proid)
KeyError: 'getpwnam(): name not found: mock-user'
INFO     [MainThread] treadmill.appmgr.abort:21 - Aborting mock-user.mock-app#0000000000
DEBUG    [MainThread] treadmill.appevents:29 - post: /tmp/treadmill.server.local/appevents: Aborted<{'why': 'KeyError'}>
INFO     [MainThread] treadmill.appcfgmgr:326 - mock-user.mock-app#0000000001 - Configuring
ERROR    [MainThread] treadmill.appmgr.configure:74 - Unable to find proid 'mock-user' in passwd database.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/configure.py", line 70, in configure
    pwd.getpwnam(app.proid)
KeyError: 'getpwnam(): name not found: mock-user'
ERROR    [MainThread] treadmill.appcfgmgr:335 - mock-user.mock-app#0000000001 - Error configuring ('/tmp/treadmill.server.local/cache/mock-user.mock-app#0000000001')
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appcfgmgr.py", line 327, in _configure
    container_dir = app_cfg.configure(self.tm_env, event_file)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/configure.py", line 70, in configure
    pwd.getpwnam(app.proid)
KeyError: 'getpwnam(): name not found: mock-user'
INFO     [MainThread] treadmill.appmgr.abort:21 - Aborting mock-user.mock-app#0000000001
DEBUG    [MainThread] treadmill.appevents:29 - post: /tmp/treadmill.server.local/appevents: Aborted<{'why': 'KeyError'}>
DEBUG    [MainThread] treadmill.appcfgmgr:302 - End resuld: set(['mock-user.mock-app-0000000001-KG6rN0IOjZs83', 'mock-user.mock-app-0000000000-yDTcc6RrDwTpH']) / set([]) - set([]) + set([])
INFO     [MainThread] treadmill.appcfgmgr:306 - running post cleanup: set([])
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svscanctl', '-an', '/tmp/treadmill.server.local/running']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/mock-user.mock-app#0000000000, wd=1, mask=DELETE, cookie=0>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/mock-user.mock-app#0000000001, wd=1, mask=DELETE, cookie=0>
INFO     [MainThread] treadmill.appcfgmgr:366 - terminating finished 'mock-user.mock-app#0000000000' ('')
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svscanctl', '-an', '/tmp/treadmill.server.local/running']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
INFO     [MainThread] treadmill.appcfgmgr:366 - terminating finished 'mock-user.mock-app#0000000001' ('')
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svscanctl', '-an', '/tmp/treadmill.server.local/running']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
WARNING  [MainThread] treadmill.watchdog:160 - Lost lease file: u'/tmp/treadmill.server.local/watchdogs/svc-CgroupResourceService'
WARNING  [MainThread] treadmill.watchdog:160 - Lost lease file: u'/tmp/treadmill.server.local/watchdogs/svc-LocalDiskResourceService'
WARNING  [MainThread] treadmill.watchdog:160 - Lost lease file: u'/tmp/treadmill.server.local/watchdogs/svc-NetworkResourceService'
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.appcfgmgr:119 - content of '/tmp/treadmill.server.local/cache' and '/tmp/treadmill.server.local/running': set([]) <-> set([])
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.appcfgmgr:119 - content of '/tmp/treadmill.server.local/cache' and '/tmp/treadmill.server.local/running': set([]) <-> set([])
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
DEBUG    [MainThread] treadmill.appcfgmgr:119 - content of '/tmp/treadmill.server.local/cache' and '/tmp/treadmill.server.local/running': set([]) <-> set([])
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.appcfgmgr:119 - content of '/tmp/treadmill.server.local/cache' and '/tmp/treadmill.server.local/running': set([]) <-> set([])
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
DEBUG    [MainThread] treadmill.appcfgmgr:119 - content of '/tmp/treadmill.server.local/cache' and '/tmp/treadmill.server.local/running': set([]) <-> set([])
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.appcfgmgr:119 - content of '/tmp/treadmill.server.local/cache' and '/tmp/treadmill.server.local/running': set([]) <-> set([])
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.appcfgmgr:119 - content of '/tmp/treadmill.server.local/cache' and '/tmp/treadmill.server.local/running': set([]) <-> set([])
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
DEBUG    [MainThread] treadmill.appcfgmgr:119 - content of '/tmp/treadmill.server.local/cache' and '/tmp/treadmill.server.local/running': set([]) <-> set([])
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.appcfgmgr:119 - content of '/tmp/treadmill.server.local/cache' and '/tmp/treadmill.server.local/running': set([]) <-> set([])
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.appcfgmgr:119 - content of '/tmp/treadmill.server.local/cache' and '/tmp/treadmill.server.local/running': set([]) <-> set([])
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
DEBUG    [MainThread] treadmill.appcfgmgr:119 - content of '/tmp/treadmill.server.local/cache' and '/tmp/treadmill.server.local/running': set([]) <-> set([])
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.appcfgmgr:119 - content of '/tmp/treadmill.server.local/cache' and '/tmp/treadmill.server.local/running': set([]) <-> set([])
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
INFO     [Thread-2  ] treadmill.eventmgr:141 - expected : mock-user.mock-app#0000000002,mock-user.mock-app#0000000000,mock-user.mock-app#0000000001
INFO     [Thread-2  ] treadmill.eventmgr:142 - actual   : 
INFO     [Thread-2  ] treadmill.eventmgr:143 - extra    : 
INFO     [Thread-2  ] treadmill.eventmgr:144 - missing  : mock-user.mock-app#0000000002,mock-user.mock-app#0000000000,mock-user.mock-app#0000000001
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.mock-user.mock-app#0000000002-JogUyk, wd=1, mask=CREATE, cookie=0>
INFO     [Thread-2  ] treadmill.eventmgr:176 - Created cache manifest: /tmp/treadmill.server.local/cache/mock-user.mock-app#0000000002
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.mock-user.mock-app#0000000002-JogUyk, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.mock-user.mock-app#0000000002-JogUyk, wd=1, mask=MOVED_FROM, cookie=4062>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/mock-user.mock-app#0000000002, wd=1, mask=MOVED_TO, cookie=4062>
INFO     [MainThread] treadmill.appcfgmgr:326 - mock-user.mock-app#0000000002 - Configuring
INFO     [Thread-2  ] treadmill.eventmgr:176 - Created cache manifest: /tmp/treadmill.server.local/cache/mock-user.mock-app#0000000000
INFO     [MainThread] treadmill.services._base_service:614 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Registering 'mock-user.mock-app-0000000002-agjQaZLUgYYxx': '/tmp/treadmill.server.local/cgroup_svc/resources/mock-user.mock-app-0000000002-agjQaZLUgYYxx' -> '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/cgroups/req-CgroupResourceService-mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.services._base_service:538 - Event on 4: {'callback': <functools.partial object at 0x32b67e0>, 'events': 1}
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cgroup_svc/resources/.tmpmock-user.mock-app-0000000002-agjQaZLUgYYxxFH7dOz, wd=1, mask=CREATE, cookie=0>
INFO     [Thread-2  ] treadmill.eventmgr:176 - Created cache manifest: /tmp/treadmill.server.local/cache/mock-user.mock-app#0000000001
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cgroup_svc/resources/.tmpmock-user.mock-app-0000000002-agjQaZLUgYYxxFH7dOz, wd=1, mask=MOVED_FROM, cookie=4064>
DEBUG    [Thread-2  ] treadmill.eventmgr:191 - cache notify (seen: True)
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cgroup_svc/resources/mock-user.mock-app-0000000002-agjQaZLUgYYxx, wd=1, mask=MOVED_TO, cookie=4064>
INFO     [MainThread] treadmill.services._base_service:614 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Registering 'mock-user.mock-app-0000000002-agjQaZLUgYYxx': '/tmp/treadmill.server.local/localdisk_svc/resources/mock-user.mock-app-0000000002-agjQaZLUgYYxx' -> '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/localdisk/req-LocalDiskResourceService-mock-user.mock-app-0000000002-agjQaZLUgYYxx'
INFO     [MainThread] treadmill.services._base_service:614 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Registering 'mock-user.mock-app-0000000002-agjQaZLUgYYxx': '/tmp/treadmill.server.local/network_svc/resources/mock-user.mock-app-0000000002-agjQaZLUgYYxx' -> '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/network/req-NetworkResourceService-mock-user.mock-app-0000000002-agjQaZLUgYYxx'
INFO     [MainThread] treadmill.services.cgroup_service:74 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Creating cgroups: ('cpu', 'cpuacct', 'memory', 'blkio'):treadmill/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
DEBUG    [MainThread] treadmill.services._base_service:538 - Event on 4: {'callback': <functools.partial object at 0x3237ec0>, 'events': 1}
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/network_svc/resources/.tmpmock-user.mock-app-0000000002-agjQaZLUgYYxxLCpLCj, wd=1, mask=CREATE, cookie=0>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/network_svc/resources/.tmpmock-user.mock-app-0000000002-agjQaZLUgYYxxLCpLCj, wd=1, mask=MOVED_FROM, cookie=4067>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/network_svc/resources/mock-user.mock-app-0000000002-agjQaZLUgYYxx, wd=1, mask=MOVED_TO, cookie=4067>
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/blkio.weight : 100
DEBUG    [MainThread] treadmill.services.network_service:150 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - req: {'environment': 'dev'}
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/cgroup.event_control : 7 8
INFO     [MainThread] treadmill.services.cgroup_service:192 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Registered OOM watcher on 'treadmill/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/memory.soft_limit_in_bytes : 200M
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/memory.limit_in_bytes : 200M
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/memory.memsw.limit_in_bytes : 200M
INFO     [MainThread] treadmill.services.cgroup_service:118 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - created in cpu:treadmill/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx with 1500 shares
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/cpu.shares : 1500
DEBUG    [MainThread] treadmill.services._base_service:784 - created 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.services._base_service:578 - Registered 7: {'callback': <function _cgroup_oom_handler at 0x32ba500>, 'events': 1}
DEBUG    [MainThread] treadmill.services._base_service:538 - Event on 4: {'callback': <functools.partial object at 0x24a92b8>, 'events': 1}
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/localdisk_svc/resources/.tmpmock-user.mock-app-0000000002-agjQaZLUgYYxxNiSGVx, wd=1, mask=CREATE, cookie=0>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/localdisk_svc/resources/.tmpmock-user.mock-app-0000000002-agjQaZLUgYYxxNiSGVx, wd=1, mask=MOVED_FROM, cookie=4066>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/localdisk_svc/resources/mock-user.mock-app-0000000002-agjQaZLUgYYxx, wd=1, mask=MOVED_TO, cookie=4066>
INFO     [MainThread] treadmill.services.localdisk_service:175 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Processing request
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['lvm', 'lvcreate', '--autobackup', 'n', '--size', '209715200B', '--name', 'agjQaZLUgYYxx', 'treadmill']
DEBUG    [MainThread] treadmill.vipfile:132 - Allocated '192.168.0.1' for 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'add', 'tm:nonprod-containers', '192.168.0.1']
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'test', 'tm:prod-containers', '192.168.0.1']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'add', 'name', 'agjQaZLUgYYxx.0', 'type', 'veth', 'peer', 'name', 'agjQaZLUgYYxx.1']
DEBUG    [MainThread] treadmill.appevents:29 - post: /tmp/treadmill.server.local/appevents: Configured<{'uniqueid': 'agjQaZLUgYYxx'}>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svscanctl', '-an', '/tmp/treadmill.server.local/running']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'agjQaZLUgYYxx.0', 'mtu', '1500']
  WARNING: This metadata update is NOT backed up
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
INFO     [MainThread] treadmill.appcfgmgr:396 - mock-user.mock-app#0000000002 - Starting
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:173 - run: ['s6-svok', '/tmp/treadmill.server.local/running/mock-user.mock-app#0000000002']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'agjQaZLUgYYxx.1', 'mtu', '1500']
DEBUG    [MainThread] treadmill.subproc:182 - Finished, rc: 1
WARNING  [MainThread] treadmill.appcfgmgr:412 - mock-user.mock-app#0000000002 - Supervisor has not picked up it yet
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'agjQaZLUgYYxx.0', 'alias', 'mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'agjQaZLUgYYxx.1', 'alias', 'mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['brctl', 'addif', 'br0', 'agjQaZLUgYYxx.0']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'agjQaZLUgYYxx.0', 'up']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.services._base_service:784 - created 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
  Logical volume "agjQaZLUgYYxx" created.
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:140 - check_output environ: (), ['lvm', 'vgdisplay', '--colon', 'treadmill']
DEBUG    [MainThread] treadmill.subproc:153 - Finished.
INFO     [MainThread] treadmill.services.localdisk_service:330 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Group 'treadmill' available space: 1069547520 (bytes)
DEBUG    [MainThread] treadmill.subproc:140 - check_output environ: (), ['lvm', 'lvdisplay', '--colon', 'treadmill/agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:153 - Finished.
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/blkio.throttle.write_bps_device : 253:4 20971520
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/blkio.throttle.read_bps_device : 253:4 20971520
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/blkio.throttle.write_iops_device : 253:4 100
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/blkio.throttle.read_iops_device : 253:4 100
DEBUG    [MainThread] treadmill.services._base_service:784 - created 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.subproc:173 - run: ['s6-svok', '/tmp/treadmill.server.local/running/mock-user.mock-app#0000000002']
DEBUG    [MainThread] treadmill.subproc:182 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-uO', '/tmp/treadmill.server.local/running/mock-user.mock-app#0000000002']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.mock-user.mock-app#0000000000-_7bUUx, wd=1, mask=CREATE, cookie=0>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.mock-user.mock-app#0000000000-_7bUUx, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.mock-user.mock-app#0000000000-_7bUUx, wd=1, mask=MOVED_FROM, cookie=4063>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/mock-user.mock-app#0000000000, wd=1, mask=MOVED_TO, cookie=4063>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.mock-user.mock-app#0000000001-ZjDeRp, wd=1, mask=CREATE, cookie=0>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.mock-user.mock-app#0000000001-ZjDeRp, wd=1, mask=MODIFY, cookie=0>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.mock-user.mock-app#0000000001-ZjDeRp, wd=1, mask=MOVED_FROM, cookie=4065>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/mock-user.mock-app#0000000001, wd=1, mask=MOVED_TO, cookie=4065>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
INFO     [MainThread] treadmill.appcfgmgr:326 - mock-user.mock-app#0000000000 - Configuring
INFO     [MainThread] treadmill.services._base_service:614 - mock-user.mock-app#0000000000 kBfpdG5TobAm4 - Registering 'mock-user.mock-app-0000000000-kBfpdG5TobAm4': '/tmp/treadmill.server.local/cgroup_svc/resources/mock-user.mock-app-0000000000-kBfpdG5TobAm4' -> '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000000-kBfpdG5TobAm4/cgroups/req-CgroupResourceService-mock-user.mock-app-0000000000-kBfpdG5TobAm4'
DEBUG    [MainThread] treadmill.services._base_service:538 - Event on 4: {'callback': <functools.partial object at 0x32b67e0>, 'events': 1}
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cgroup_svc/resources/.tmpmock-user.mock-app-0000000000-kBfpdG5TobAm4JfmkHs, wd=1, mask=CREATE, cookie=0>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cgroup_svc/resources/.tmpmock-user.mock-app-0000000000-kBfpdG5TobAm4JfmkHs, wd=1, mask=MOVED_FROM, cookie=4089>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cgroup_svc/resources/mock-user.mock-app-0000000000-kBfpdG5TobAm4, wd=1, mask=MOVED_TO, cookie=4089>
INFO     [MainThread] treadmill.services._base_service:614 - mock-user.mock-app#0000000000 kBfpdG5TobAm4 - Registering 'mock-user.mock-app-0000000000-kBfpdG5TobAm4': '/tmp/treadmill.server.local/localdisk_svc/resources/mock-user.mock-app-0000000000-kBfpdG5TobAm4' -> '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000000-kBfpdG5TobAm4/localdisk/req-LocalDiskResourceService-mock-user.mock-app-0000000000-kBfpdG5TobAm4'
DEBUG    [MainThread] treadmill.services._base_service:538 - Event on 4: {'callback': <functools.partial object at 0x24a92b8>, 'events': 1}
INFO     [MainThread] treadmill.services.cgroup_service:74 - mock-user.mock-app#0000000000 kBfpdG5TobAm4 - mock-user.mock-app-0000000000-kBfpdG5TobAm4 - Creating cgroups: ('cpu', 'cpuacct', 'memory', 'blkio'):treadmill/apps/mock-user.mock-app-0000000000-kBfpdG5TobAm4
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/localdisk_svc/resources/.tmpmock-user.mock-app-0000000000-kBfpdG5TobAm4BWHiTu, wd=1, mask=CREATE, cookie=0>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/localdisk_svc/resources/.tmpmock-user.mock-app-0000000000-kBfpdG5TobAm4BWHiTu, wd=1, mask=MOVED_FROM, cookie=4090>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/localdisk_svc/resources/mock-user.mock-app-0000000000-kBfpdG5TobAm4, wd=1, mask=MOVED_TO, cookie=4090>
INFO     [MainThread] treadmill.services._base_service:614 - mock-user.mock-app#0000000000 kBfpdG5TobAm4 - Registering 'mock-user.mock-app-0000000000-kBfpdG5TobAm4': '/tmp/treadmill.server.local/network_svc/resources/mock-user.mock-app-0000000000-kBfpdG5TobAm4' -> '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000000-kBfpdG5TobAm4/network/req-NetworkResourceService-mock-user.mock-app-0000000000-kBfpdG5TobAm4'
DEBUG    [MainThread] treadmill.services._base_service:538 - Event on 4: {'callback': <functools.partial object at 0x3237ec0>, 'events': 1}
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/network_svc/resources/.tmpmock-user.mock-app-0000000000-kBfpdG5TobAm4F2Vr8_, wd=1, mask=CREATE, cookie=0>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/network_svc/resources/.tmpmock-user.mock-app-0000000000-kBfpdG5TobAm4F2Vr8_, wd=1, mask=MOVED_FROM, cookie=4091>
INFO     [MainThread] treadmill.services.localdisk_service:175 - mock-user.mock-app#0000000000 kBfpdG5TobAm4 - mock-user.mock-app-0000000000-kBfpdG5TobAm4 - Processing request
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/network_svc/resources/mock-user.mock-app-0000000000-kBfpdG5TobAm4, wd=1, mask=MOVED_TO, cookie=4091>
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/apps/mock-user.mock-app-0000000000-kBfpdG5TobAm4/blkio.weight : 100
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['lvm', 'lvcreate', '--autobackup', 'n', '--size', '209715200B', '--name', 'kBfpdG5TobAm4', 'treadmill']
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/apps/mock-user.mock-app-0000000000-kBfpdG5TobAm4/cgroup.event_control : 8 9
INFO     [MainThread] treadmill.services.cgroup_service:192 - mock-user.mock-app#0000000000 kBfpdG5TobAm4 - Registered OOM watcher on 'treadmill/apps/mock-user.mock-app-0000000000-kBfpdG5TobAm4'
DEBUG    [MainThread] treadmill.services.network_service:150 - mock-user.mock-app#0000000000 kBfpdG5TobAm4 - mock-user.mock-app-0000000000-kBfpdG5TobAm4 - req: {'environment': 'dev'}
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/apps/mock-user.mock-app-0000000000-kBfpdG5TobAm4/memory.soft_limit_in_bytes : 200M
DEBUG    [MainThread] treadmill.vipfile:132 - Allocated '192.168.0.2' for 'mock-user.mock-app-0000000000-kBfpdG5TobAm4'
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'add', 'tm:nonprod-containers', '192.168.0.2']
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/apps/mock-user.mock-app-0000000000-kBfpdG5TobAm4/memory.limit_in_bytes : 200M
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/apps/mock-user.mock-app-0000000000-kBfpdG5TobAm4/memory.memsw.limit_in_bytes : 200M
INFO     [MainThread] treadmill.services.cgroup_service:118 - mock-user.mock-app#0000000000 kBfpdG5TobAm4 - mock-user.mock-app-0000000000-kBfpdG5TobAm4 - created in cpu:treadmill/apps/mock-user.mock-app-0000000000-kBfpdG5TobAm4 with 1500 shares
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/apps/mock-user.mock-app-0000000000-kBfpdG5TobAm4/cpu.shares : 1500
DEBUG    [MainThread] treadmill.services._base_service:784 - created 'mock-user.mock-app-0000000000-kBfpdG5TobAm4'
DEBUG    [MainThread] treadmill.services._base_service:578 - Registered 8: {'callback': <function _cgroup_oom_handler at 0x32ba578>, 'events': 1}
DEBUG    [MainThread] treadmill.appevents:29 - post: /tmp/treadmill.server.local/appevents: Configured<{'uniqueid': 'kBfpdG5TobAm4'}>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svscanctl', '-an', '/tmp/treadmill.server.local/running']
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'test', 'tm:prod-containers', '192.168.0.2']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
INFO     [MainThread] treadmill.appcfgmgr:396 - mock-user.mock-app#0000000000 - Starting
DEBUG    [MainThread] treadmill.subproc:173 - run: ['s6-svok', '/tmp/treadmill.server.local/running/mock-user.mock-app#0000000000']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'add', 'name', 'kBfpdG5TobAm4.0', 'type', 'veth', 'peer', 'name', 'kBfpdG5TobAm4.1']
DEBUG    [MainThread] treadmill.subproc:182 - Finished, rc: 1
WARNING  [MainThread] treadmill.appcfgmgr:412 - mock-user.mock-app#0000000000 - Supervisor has not picked up it yet
  WARNING: This metadata update is NOT backed up
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'kBfpdG5TobAm4.0', 'mtu', '1500']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'kBfpdG5TobAm4.1', 'mtu', '1500']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'kBfpdG5TobAm4.0', 'alias', 'mock-user.mock-app-0000000000-kBfpdG5TobAm4']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'kBfpdG5TobAm4.1', 'alias', 'mock-user.mock-app-0000000000-kBfpdG5TobAm4']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['brctl', 'addif', 'br0', 'kBfpdG5TobAm4.0']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'kBfpdG5TobAm4.0', 'up']
  Logical volume "kBfpdG5TobAm4" created.
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:140 - check_output environ: (), ['lvm', 'vgdisplay', '--colon', 'treadmill']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.services._base_service:784 - created 'mock-user.mock-app-0000000000-kBfpdG5TobAm4'
DEBUG    [MainThread] treadmill.subproc:153 - Finished.
INFO     [MainThread] treadmill.services.localdisk_service:330 - mock-user.mock-app#0000000000 kBfpdG5TobAm4 - Group 'treadmill' available space: 1069547520 (bytes)
DEBUG    [MainThread] treadmill.subproc:140 - check_output environ: (), ['lvm', 'lvdisplay', '--colon', 'treadmill/kBfpdG5TobAm4']
DEBUG    [MainThread] treadmill.subproc:153 - Finished.
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/apps/mock-user.mock-app-0000000000-kBfpdG5TobAm4/blkio.throttle.write_bps_device : 253:5 20971520
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/apps/mock-user.mock-app-0000000000-kBfpdG5TobAm4/blkio.throttle.read_bps_device : 253:5 20971520
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/apps/mock-user.mock-app-0000000000-kBfpdG5TobAm4/blkio.throttle.write_iops_device : 253:5 100
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/apps/mock-user.mock-app-0000000000-kBfpdG5TobAm4/blkio.throttle.read_iops_device : 253:5 100
DEBUG    [MainThread] treadmill.services._base_service:784 - created 'mock-user.mock-app-0000000000-kBfpdG5TobAm4'
DEBUG    [MainThread] treadmill.subproc:173 - run: ['s6-svok', '/tmp/treadmill.server.local/running/mock-user.mock-app#0000000000']
DEBUG    [MainThread] treadmill.subproc:182 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-uO', '/tmp/treadmill.server.local/running/mock-user.mock-app#0000000000']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
INFO     [MainThread] treadmill.appcfgmgr:326 - mock-user.mock-app#0000000001 - Configuring
INFO     [MainThread] treadmill.services._base_service:614 - mock-user.mock-app#0000000001 pdGegNug5wXpE - Registering 'mock-user.mock-app-0000000001-pdGegNug5wXpE': '/tmp/treadmill.server.local/cgroup_svc/resources/mock-user.mock-app-0000000001-pdGegNug5wXpE' -> '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/cgroups/req-CgroupResourceService-mock-user.mock-app-0000000001-pdGegNug5wXpE'
DEBUG    [MainThread] treadmill.services._base_service:538 - Event on 4: {'callback': <functools.partial object at 0x32b67e0>, 'events': 1}
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cgroup_svc/resources/.tmpmock-user.mock-app-0000000001-pdGegNug5wXpEbBOZTV, wd=1, mask=CREATE, cookie=0>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cgroup_svc/resources/.tmpmock-user.mock-app-0000000001-pdGegNug5wXpEbBOZTV, wd=1, mask=MOVED_FROM, cookie=4115>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cgroup_svc/resources/mock-user.mock-app-0000000001-pdGegNug5wXpE, wd=1, mask=MOVED_TO, cookie=4115>
INFO     [MainThread] treadmill.services.cgroup_service:74 - mock-user.mock-app#0000000001 pdGegNug5wXpE - mock-user.mock-app-0000000001-pdGegNug5wXpE - Creating cgroups: ('cpu', 'cpuacct', 'memory', 'blkio'):treadmill/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/blkio.weight : 100
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/cgroup.event_control : 9 10
INFO     [MainThread] treadmill.services.cgroup_service:192 - mock-user.mock-app#0000000001 pdGegNug5wXpE - Registered OOM watcher on 'treadmill/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE'
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/memory.soft_limit_in_bytes : 200M
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/memory.limit_in_bytes : 200M
INFO     [MainThread] treadmill.services._base_service:614 - mock-user.mock-app#0000000001 pdGegNug5wXpE - Registering 'mock-user.mock-app-0000000001-pdGegNug5wXpE': '/tmp/treadmill.server.local/localdisk_svc/resources/mock-user.mock-app-0000000001-pdGegNug5wXpE' -> '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/localdisk/req-LocalDiskResourceService-mock-user.mock-app-0000000001-pdGegNug5wXpE'
INFO     [MainThread] treadmill.services._base_service:614 - mock-user.mock-app#0000000001 pdGegNug5wXpE - Registering 'mock-user.mock-app-0000000001-pdGegNug5wXpE': '/tmp/treadmill.server.local/network_svc/resources/mock-user.mock-app-0000000001-pdGegNug5wXpE' -> '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/network/req-NetworkResourceService-mock-user.mock-app-0000000001-pdGegNug5wXpE'
DEBUG    [MainThread] treadmill.services._base_service:538 - Event on 4: {'callback': <functools.partial object at 0x3237ec0>, 'events': 1}
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/network_svc/resources/.tmpmock-user.mock-app-0000000001-pdGegNug5wXpE3A9LWI, wd=1, mask=CREATE, cookie=0>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/network_svc/resources/.tmpmock-user.mock-app-0000000001-pdGegNug5wXpE3A9LWI, wd=1, mask=MOVED_FROM, cookie=4117>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/network_svc/resources/mock-user.mock-app-0000000001-pdGegNug5wXpE, wd=1, mask=MOVED_TO, cookie=4117>
DEBUG    [MainThread] treadmill.services._base_service:538 - Event on 4: {'callback': <functools.partial object at 0x24a92b8>, 'events': 1}
DEBUG    [MainThread] treadmill.services.network_service:150 - mock-user.mock-app#0000000001 pdGegNug5wXpE - mock-user.mock-app-0000000001-pdGegNug5wXpE - req: {'environment': 'dev'}
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/localdisk_svc/resources/.tmpmock-user.mock-app-0000000001-pdGegNug5wXpECCu0We, wd=1, mask=CREATE, cookie=0>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/localdisk_svc/resources/.tmpmock-user.mock-app-0000000001-pdGegNug5wXpECCu0We, wd=1, mask=MOVED_FROM, cookie=4116>
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/localdisk_svc/resources/mock-user.mock-app-0000000001-pdGegNug5wXpE, wd=1, mask=MOVED_TO, cookie=4116>
INFO     [MainThread] treadmill.services.localdisk_service:175 - mock-user.mock-app#0000000001 pdGegNug5wXpE - mock-user.mock-app-0000000001-pdGegNug5wXpE - Processing request
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['lvm', 'lvcreate', '--autobackup', 'n', '--size', '209715200B', '--name', 'pdGegNug5wXpE', 'treadmill']
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/memory/treadmill/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/memory.memsw.limit_in_bytes : 200M
DEBUG    [MainThread] treadmill.vipfile:132 - Allocated '192.168.0.3' for 'mock-user.mock-app-0000000001-pdGegNug5wXpE'
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'add', 'tm:nonprod-containers', '192.168.0.3']
INFO     [MainThread] treadmill.services.cgroup_service:118 - mock-user.mock-app#0000000001 pdGegNug5wXpE - mock-user.mock-app-0000000001-pdGegNug5wXpE - created in cpu:treadmill/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE with 1500 shares
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/cpu,cpuacct/treadmill/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/cpu.shares : 1500
DEBUG    [MainThread] treadmill.services._base_service:784 - created 'mock-user.mock-app-0000000001-pdGegNug5wXpE'
DEBUG    [MainThread] treadmill.services._base_service:578 - Registered 9: {'callback': <function _cgroup_oom_handler at 0x32ba5f0>, 'events': 1}
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'test', 'tm:prod-containers', '192.168.0.3']
DEBUG    [MainThread] treadmill.appevents:29 - post: /tmp/treadmill.server.local/appevents: Configured<{'uniqueid': 'pdGegNug5wXpE'}>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svscanctl', '-an', '/tmp/treadmill.server.local/running']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'add', 'name', 'pdGegNug5wXpE.0', 'type', 'veth', 'peer', 'name', 'pdGegNug5wXpE.1']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
INFO     [MainThread] treadmill.appcfgmgr:396 - mock-user.mock-app#0000000001 - Starting
DEBUG    [MainThread] treadmill.subproc:173 - run: ['s6-svok', '/tmp/treadmill.server.local/running/mock-user.mock-app#0000000001']
  WARNING: This metadata update is NOT backed up
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'pdGegNug5wXpE.0', 'mtu', '1500']
DEBUG    [MainThread] treadmill.subproc:182 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-uO', '/tmp/treadmill.server.local/running/mock-user.mock-app#0000000001']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'pdGegNug5wXpE.1', 'mtu', '1500']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'pdGegNug5wXpE.0', 'alias', 'mock-user.mock-app-0000000001-pdGegNug5wXpE']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
  Logical volume "pdGegNug5wXpE" created.
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:140 - check_output environ: (), ['lvm', 'vgdisplay', '--colon', 'treadmill']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'pdGegNug5wXpE.1', 'alias', 'mock-user.mock-app-0000000001-pdGegNug5wXpE']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['brctl', 'addif', 'br0', 'pdGegNug5wXpE.0']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['ip', 'link', 'set', 'dev', 'pdGegNug5wXpE.0', 'up']
DEBUG    [MainThread] treadmill.subproc:153 - Finished.
INFO     [MainThread] treadmill.services.localdisk_service:330 - mock-user.mock-app#0000000001 pdGegNug5wXpE - Group 'treadmill' available space: 1069547520 (bytes)
DEBUG    [MainThread] treadmill.subproc:140 - check_output environ: (), ['lvm', 'lvdisplay', '--colon', 'treadmill/pdGegNug5wXpE']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.services._base_service:784 - created 'mock-user.mock-app-0000000001-pdGegNug5wXpE'
DEBUG    [MainThread] treadmill.subproc:153 - Finished.
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/blkio.throttle.write_bps_device : 253:6 20971520
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/blkio.throttle.read_bps_device : 253:6 20971520
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/blkio.throttle.write_iops_device : 253:6 100
DEBUG    [MainThread] treadmill.cgroups:62 - /sys/fs/cgroup/blkio/treadmill/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/blkio.throttle.read_iops_device : 253:6 100
DEBUG    [MainThread] treadmill.services._base_service:784 - created 'mock-user.mock-app-0000000001-pdGegNug5wXpE'
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx, wd=1, mask=CREATE, cookie=0>
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
CRITICAL [MainThread] treadmill.appmgr.finish:388 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cannot open /proc/22059/root
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 381, in _kill_apps_by_root
    procroot = os.readlink(proc + '/root')
OSError: [Errno 2] No such file or directory: '/proc/22059/root'
INFO     [MainThread] treadmill.fs:430 - Nothing to archive.
INFO     [MainThread] treadmill.services._base_service:629 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unegistering 'mock-user.mock-app-0000000002-agjQaZLUgYYxx': '/tmp/treadmill.server.local/localdisk_svc/resources/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.services._base_service:538 - Event on 4: {'callback': <functools.partial object at 0x24a92b8>, 'events': 1}
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/localdisk_svc/resources/mock-user.mock-app-0000000002-agjQaZLUgYYxx, wd=1, mask=DELETE, cookie=0>
DEBUG    [MainThread] treadmill.services._base_service:807 - deleted 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['lvm', 'lvremove', '--autobackup', 'n', '--force', 'treadmill/agjQaZLUgYYxx']
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
  Logical volume treadmill/agjQaZLUgYYxx contains a filesystem in use.
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
WARNING  [MainThread] treadmill.subproc:124 - None
WARNING  [MainThread] treadmill.services.localdisk_service:288 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Ignoring unknow volume 'agjQaZLUgYYxx'
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 100, in top
    watcher.process_events(max_events=_MAX_REQUEST_PER_CYCLE)
  File "/home/vagrant/treadmill/lib/python/treadmill/idirwatch.py", line 212, in process_events
    res = self.on_created(event.src_path)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22074
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22074
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22074
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22074
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22117
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22117
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22117
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22117
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22160
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22160
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22160
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22160
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22203
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22203
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22203
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22203
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22246
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22246
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22246
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22246
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22289
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22289
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22289
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22289
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22332
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22332
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22332
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22332
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22376
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22376
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22376
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22376
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22419
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22419
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22419
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22419
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22462
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22462
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22462
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22462
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22512
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22512
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22512
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22512
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22555
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22555
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22555
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22555
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22598
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22598
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22598
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22598
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22642
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22642
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22642
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22642
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22686
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22686
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22686
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22686
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22729
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22729
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22729
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22729
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22772
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22772
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22772
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22772
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22815
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22815
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22815
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22815
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22858
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22858
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22858
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22858
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22901
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22901
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22901
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22901
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22944
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22944
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22944
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22944
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 22987
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22987
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 22987
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 22987
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23030
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23030
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23030
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23030
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23073
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23073
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23073
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23073
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23116
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23116
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23116
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23116
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23159
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23159
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23159
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23159
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23202
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23202
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23202
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23202
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23245
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23245
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23245
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23245
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23288
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23288
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23288
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23288
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23331
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23331
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23331
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23331
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23374
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23374
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23374
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23374
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23417
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23417
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23417
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23417
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23460
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23460
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23460
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23460
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23503
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23503
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23503
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23503
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23546
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23546
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23546
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23546
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23589
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23589
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23589
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23589
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23632
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23632
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23632
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23632
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23675
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23675
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23675
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23675
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.appcfgmgr:119 - content of '/tmp/treadmill.server.local/cache' and '/tmp/treadmill.server.local/running': set(['mock-user.mock-app-0000000002-agjQaZLUgYYxx', 'mock-user.mock-app-0000000001-pdGegNug5wXpE', 'mock-user.mock-app-0000000000-kBfpdG5TobAm4']) <-> set(['mock-user.mock-app#0000000002', 'mock-user.mock-app#0000000000', 'mock-user.mock-app#0000000001'])
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23718
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23718
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23718
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23718
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23761
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23761
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23761
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23761
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23804
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23804
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23804
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23804
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23849
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23849
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23849
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23849
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23892
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23892
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23892
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23892
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23935
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23935
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23935
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23935
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 23978
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23978
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 23978
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 23978
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24021
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24021
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24021
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24021
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24064
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24064
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24064
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24064
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24107
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24107
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24107
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24107
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24151
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24151
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24151
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24151
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24194
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24194
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24194
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24194
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24237
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24237
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24237
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24237
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24280
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24280
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24280
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24280
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24323
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24323
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24323
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24323
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24366
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24366
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24366
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24366
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24409
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24409
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24409
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24409
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24452
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24452
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24452
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24452
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24495
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24495
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24495
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24495
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24538
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24538
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24538
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24538
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24581
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24581
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24581
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24581
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24624
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24624
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24624
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24624
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24667
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24667
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24667
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24667
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24710
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24710
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24710
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24710
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24753
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24753
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24753
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24753
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24796
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24796
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24796
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24796
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24839
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24839
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24839
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24839
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24882
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24882
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24882
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24882
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24925
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24925
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24925
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24925
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 24968
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24968
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 24968
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 24968
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25011
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25011
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25011
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25011
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25054
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25054
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25054
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25054
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25097
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25097
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25097
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25097
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25140
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25140
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25140
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25140
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25183
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25183
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25183
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25183
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25226
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25226
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25226
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25226
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25269
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25269
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25269
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25269
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25312
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25312
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25312
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25312
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25355
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25355
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25355
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25355
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25405
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25405
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25405
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25405
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25448
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25448
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25448
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25448
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25491
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25491
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25491
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25491
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25534
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25534
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25534
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25534
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25577
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25577
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25577
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25577
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25620
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25620
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25620
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25620
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25671
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25671
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25671
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25671
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25714
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25714
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25714
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25714
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25757
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25757
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25757
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25757
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25800
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25800
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25800
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25800
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25851
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25851
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25851
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25851
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25894
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25894
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25894
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25894
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25937
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25937
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25937
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25937
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 25980
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25980
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 25980
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 25980
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26023
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26023
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26023
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26023
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26066
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26066
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26066
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26066
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26109
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26109
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26109
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26109
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26152
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26152
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26152
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26152
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26195
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26195
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26195
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26195
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.appcfgmgr:119 - content of '/tmp/treadmill.server.local/cache' and '/tmp/treadmill.server.local/running': set(['mock-user.mock-app-0000000002-agjQaZLUgYYxx', 'mock-user.mock-app-0000000001-pdGegNug5wXpE', 'mock-user.mock-app-0000000000-kBfpdG5TobAm4']) <-> set(['mock-user.mock-app#0000000002', 'mock-user.mock-app#0000000000', 'mock-user.mock-app#0000000001'])
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26247
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26247
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26247
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26247
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26290
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26290
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26290
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26290
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26333
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26333
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26333
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26333
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26384
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26384
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26384
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26384
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26427
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26427
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26427
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26427
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26470
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26470
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26470
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26470
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26513
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26513
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26513
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26513
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26556
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26556
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26556
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26556
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26599
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26599
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26599
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26599
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26642
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26642
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26642
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26642
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26693
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26693
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26693
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26693
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26736
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26736
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26736
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26736
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26788
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26788
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26788
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26788
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26831
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26831
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26831
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26831
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26874
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26874
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26874
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26874
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26916
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26916
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26916
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26916
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 26960
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26960
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 26960
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 26960
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27004
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27004
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27004
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27004
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27047
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27047
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27047
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27047
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27090
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27090
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27090
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27090
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27133
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27133
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27133
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27133
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27183
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27183
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27183
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27183
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27226
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27226
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27226
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27226
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27269
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27269
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27269
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27269
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27313
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27313
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27313
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27313
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27356
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27356
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27356
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27356
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27399
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27399
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27399
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27399
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27442
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27442
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27442
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27442
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27485
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27485
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27485
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27485
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27535
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27535
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27535
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27535
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.appcfgmgr:119 - content of '/tmp/treadmill.server.local/cache' and '/tmp/treadmill.server.local/running': set(['mock-user.mock-app-0000000002-agjQaZLUgYYxx', 'mock-user.mock-app-0000000001-pdGegNug5wXpE', 'mock-user.mock-app-0000000000-kBfpdG5TobAm4']) <-> set(['mock-user.mock-app#0000000002', 'mock-user.mock-app#0000000000', 'mock-user.mock-app#0000000001'])
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27578
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27578
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27578
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27578
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27621
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27621
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27621
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27621
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27664
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27664
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27664
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27664
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27707
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27707
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27707
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27707
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27754
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27754
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27754
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27754
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27802
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27802
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27802
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27802
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27845
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27845
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27845
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27845
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27888
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27888
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27888
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27888
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27931
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27931
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27931
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27931
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 27974
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27974
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 27974
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 27974
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28018
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28018
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28018
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28018
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28065
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28065
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28065
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28065
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28108
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28108
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28108
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28108
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28160
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28160
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28160
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28160
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28212
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28212
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28212
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28212
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28255
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28255
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28255
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28255
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28307
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28307
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28307
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28307
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28350
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28350
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28350
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28350
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28393
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28393
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28393
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28393
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28436
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28436
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28436
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28436
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28484
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28484
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28484
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28484
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28527
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28527
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28527
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28527
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28570
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28570
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28570
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28570
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28613
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28613
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28613
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28613
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28656
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28656
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28656
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28656
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28699
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28699
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28699
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28699
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28742
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28742
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28742
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28742
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28785
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28785
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28785
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28785
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28837
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28837
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28837
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28837
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28880
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28880
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28880
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28880
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: True)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=MODIFY, cookie=0>
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28927
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28927
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28927
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28927
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 28975
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28975
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 28975
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 28975
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29027
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29027
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29027
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29027
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29075
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29075
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29075
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29075
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29118
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29118
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29118
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29118
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29161
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29161
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29161
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29161
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29204
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29204
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29204
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29204
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29247
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29247
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29247
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29247
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29290
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29290
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29290
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29290
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29333
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29333
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29333
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29333
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29376
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29376
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29376
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29376
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29419
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29419
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29419
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29419
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29462
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29462
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29462
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29462
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29505
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29505
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29505
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29505
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29548
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29548
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29548
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29548
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29591
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29591
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29591
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29591
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29634
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29634
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29634
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29634
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29677
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29677
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29677
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29677
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29720
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29720
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29720
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29720
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29763
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29763
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29763
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29763
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29806
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29806
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29806
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29806
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29849
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29849
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29849
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29849
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29892
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29892
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29892
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29892
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29935
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29935
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29935
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29935
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
WARNING  [MainThread] treadmill.subproc:124 - None
ERROR    [MainThread] treadmill.sproc.cleanup:80 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Fatal error running '/home/vagrant/treadmill/bin/treadmill'.
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 95, in top
    _on_created(pending_cleanup)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/cleanup.py", line 76, in _on_created
    container_dir
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 120, in check_call
    **kwargs)
  File "/usr/lib64/python2.7/subprocess.py", line 542, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']' returned non-zero exit status 1
WARNING  [MainThread] treadmill.watchdog:54 - Watchdog failed: 'svc-Cleanup'.
WARNING  [MainThread] treadmill.sproc.init:147 - Shutting down: watchdogs [('svc-Cleanup', 1492870241.179006, "Service 'Cleanup' failed")] failed.
DEBUG    [MainThread] treadmill.zkutils:519 - Deleting /server.presence/localhost
INFO     [Thread-2  ] treadmill.eventmgr:95 - Presence node deleted.
DEBUG    [Thread-2  ] treadmill.eventmgr:191 - cache notify (seen: False)
DEBUG    [MainThread] treadmill.syscall.inotify:462 - Received event <InotifyEvent: src_path=/tmp/treadmill.server.local/cache/.seen, wd=1, mask=DELETE, cookie=0>
INFO     [MainThread] treadmill.appcfgmgr:192 - Cache folder not ready. Stoping processing of events.
INFO     [MainThread] root:22 - creating and joining: memory/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/tasks : 29978
INFO     [MainThread] root:22 - creating and joining: cpu/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29978
INFO     [MainThread] root:22 - creating and joining: cpuacct/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/tasks : 29978
INFO     [MainThread] root:22 - creating and joining: blkio/treadmill/core/cleanup
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/blkio/treadmill/core/cleanup/tasks : 29978
INFO     [MainThread] root:31 - setting memory.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.memsw.limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.memsw.limit_in_bytes : 536870912
INFO     [MainThread] root:31 - setting memory.soft_limit_in_bytes: 536870912
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/memory/treadmill/core/cleanup/memory.soft_limit_in_bytes : 536870912
INFO     [MainThread] root:37 - setting cpu.shares: 204
DEBUG    [MainThread] treadmill.cgroups:62 - /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000001-pdGegNug5wXpE/root/sys/fs/cgroup/cpu,cpuacct/treadmill/core/cleanup/cpu.shares : 204
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: svc-Cleanup:300>
INFO     [MainThread] treadmill.idirwatch:98 - Watching directoy '/tmp/treadmill.server.local/cleanup' (id: 1)
INFO     [MainThread] treadmill.sproc.cleanup:59 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cleanup: /tmp/treadmill.server.local/cleanup/mock-user.mock-app-0000000002-agjQaZLUgYYxx => /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx
INFO     [MainThread] treadmill.sproc.cleanup:70 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - invoking treadmill_bin script: '/home/vagrant/treadmill/bin/treadmill'
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['/home/vagrant/treadmill/bin/treadmill', 'sproc', 'finish', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.netdev:487 - Setting '/proc/sys/net/ipv4/conf/tm0/forwarding' to 0
INFO     [MainThread] treadmill.sproc.init:189 - try to shutdown cleanup service
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/init/cleanup']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svwait', '-d', '/tmp/treadmill.server.local/init/cleanup']
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
INFO     [MainThread] treadmill.sproc.init:194 - try to shutdown supervisor
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/init/supervisor']
s6-svscan: warning: unable to exec finish script .s6-svscan/finish: No such file or directory
s6-svscan: warning: executing into .s6-svscan/crash
DEBUG    [MainThread] treadmill.subproc:121 - Finished, rc: 0
s6-svscan: fatal: unable to exec .s6-svscan/crash: No such file or directory
INFO     [MainThread] treadmill.sproc.finish:29 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finish (approot /tmp/treadmill.server.local)
DEBUG    [MainThread] treadmill.context:92 - Connecting to Zookeeper zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:235 - Connecting to zookeeper://localhost:2181
DEBUG    [MainThread] treadmill.zkutils:262 - Connecting to zookeeper: {'auth_data': [], 'connection_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'hosts': 'localhost:2181', 'command_retry': {'max_jitter': 0.2, 'max_delay': 1, 'delay': 0.2, 'max_tries': 30, 'backoff': 2, 'ignore_expire': False}, 'client_id': None}
DEBUG    [Thread-3  ] treadmill.zkutils:181 - ZK connection state: CONNECTED
INFO     [MainThread] treadmill.appmgr.finish:64 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app#0000000002 agjQaZLUgYYxx - finishing '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'
DEBUG    [MainThread] treadmill.watchdog:121 - Setting up watchdog: <Lease: treadmill.appmgr.finish-mock-user.mock-app-0000000002-agjQaZLUgYYxx:300>
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['s6-svc', '-d', '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx']
DEBUG    [MainThread] treadmill.subproc:29 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
DEBUG    [MainThread] treadmill.subproc:33 - Loading whitelist: /home/vagrant/treadmill/etc/linux.exe.config
s6-svc: fatal: unable to control /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx: supervisor not listening
WARNING  [MainThread] treadmill.subproc:124 - None
INFO     [MainThread] treadmill.appmgr.finish:159 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Cannot control supervisor of '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx'.
DEBUG    [MainThread] treadmill.appmgr.finish:428 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unable to read container exitinfo: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo
INFO     [MainThread] treadmill.appmgr.finish:116 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for exitinfo file '/tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/exitinfo': None
INFO     [MainThread] treadmill.appmgr.finish:120 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - check for aborted file: /tmp/treadmill.server.local/apps/mock-user.mock-app-0000000002-agjQaZLUgYYxx/aborted, True
DEBUG    [MainThread] treadmill.appmgr.finish:136 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Manifest: {'shared_network': False, 'features': [], 'ephemeral_ports': {'udp': [], 'tcp': []}, 'passthrough': [], 'app': 'mock-user.mock-app', 'zookeeper': 'zookeeper://localhost:2181', 'vip': {'ip0': '192.168.254.254', 'ip1': '192.168.0.1'}, 'shared_ip': False, 'disk': '200M', 'archive': [], 'environment': 'dev', 'network': {'vip': '192.168.0.1', 'gateway': '192.168.254.254', 'veth': 'agjQaZLUgYYxx.1'}, 'cell': 'gaocegege', 'affinity': 'mock-user.mock-app', 'memory': '200M', 'identity_group': None, 'data_retention_timeout': None, 'expires': 1492870078.424311, 'host_ip': '10.0.2.15', 'vring': {'cells': []}, 'uniqueid': 'agjQaZLUgYYxx', 'services': [{'command': '/bin/sleep 30s', 'root': False, 'name': 'sleep', 'restart': {'interval': 60, 'limit': 0}}], 'affinity_limits': {}, 'identity': None, 'tickets': [], 'task': '0000000002', 'name': 'mock-user.mock-app#0000000002', 'system_services': [{'command': '/usr/sbin/sshd -D -f /etc/ssh/sshd_config -p $TREADMILL_ENDPOINT_SSH', 'name': 'sshd', 'restart': {'interval': 60, 'limit': 5}, 'proid': None}], 'environ': [], 'proid': 'mock-user', 'endpoints': [{'port': 44763, 'proto': 'tcp', 'type': 'infra', 'name': 'ssh', 'real_port': 44763}], 'cpu': 30}
ERROR    [MainThread] treadmill.appmgr.finish:234 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Unknown exception while archiving 'mock-user.mock-app-0000000002-agjQaZLUgYYxx'
Traceback (most recent call last):
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 222, in _cleanup
    localdisk['block_dev'],
TypeError: 'NoneType' object has no attribute '__getitem__'
WARNING  [MainThread] treadmill.services._base_service:193 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - mock-user.mock-app-0000000002-agjQaZLUgYYxx - Resource 'mock-user.mock-app-0000000002-agjQaZLUgYYxx' does not exist
INFO     [MainThread] treadmill.appmgr.finish:306 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - Deleting passthrough for: []
INFO     [MainThread] treadmill.rulefile:171 - Network rule '/tmp/treadmill.server.local/rules/dnat:tcp:10.0.2.15:44763-192.168.0.1:44763' does not exist.
DEBUG    [MainThread] treadmill.appmgr.finish:332 - mock-user.mock-app#0000000002 agjQaZLUgYYxx - removing 192.168.0.1:44763 from infra services set
DEBUG    [MainThread] treadmill.subproc:209 - invoke: ['ipset', '-exist', 'del', 'tm:infra-services', '192.168.0.1,tcp:44763']
DEBUG    [MainThread] treadmill.subproc:107 - check_call environ: (), runas: None, ['conntrack', '-D', '-g', '192.168.0.1']
Not found:  conntrack /usr/sbin/conntrack
CRITICAL [MainThread] treadmill.subproc:77 - Command not found: conntrack, /usr/sbin/conntrack
Traceback (most recent call last):
  File "/usr/lib64/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/home/vagrant/treadmill/lib/python/treadmill/__main__.py", line 88, in <module>
    run()
  File "/usr/lib/python2.7/site-packages/click/core.py", line 722, in __call__
    return self.main(*args, **kwargs)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 697, in main
    rv = self.invoke(ctx)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 1066, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/usr/lib/python2.7/site-packages/click/core.py", line 895, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/usr/lib/python2.7/site-packages/click/core.py", line 535, in invoke
    return callback(*args, **kwargs)
  File "/home/vagrant/treadmill/lib/python/treadmill/sproc/finish.py", line 31, in finish
    app_finish.finish(app_env, context.GLOBAL.zk.conn, container_dir)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 83, in finish
    _cleanup(tm_env, zkclient, container_dir, app)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 246, in _cleanup
    _cleanup_network(tm_env, app, network_client)
  File "/home/vagrant/treadmill/lib/python/treadmill/appmgr/finish.py", line 348, in _cleanup_network
    iptables.flush_conntrack_table(app_network['vip'])
  File "/home/vagrant/treadmill/lib/python/treadmill/iptables.py", line 635, in flush_conntrack_table
    subproc.check_call(['conntrack', '-D', '-g', vip])
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 109, in check_call
    args = _whitelist_command(cmdline)
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 86, in _whitelist_command
    safe_cmdline.insert(0, resolve(safe_cmdline.pop(0)))
  File "/home/vagrant/treadmill/lib/python/treadmill/subproc.py", line 78, in resolve
    raise CommandWhitelistError()
treadmill.subproc.CommandWhitelistError
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
INFO     [MainThread] treadmill.appcfgmgr:122 - Still inactive during heartbeat event.
DEBUG    [MainThread] treadmill.eventmgr:191 - cache notify (seen: False)
INFO     [MainThread] treadmill.eventmgr:116 - Refresh watchdog.
